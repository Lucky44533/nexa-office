<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nexa Writer</title>
<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background-color: #f0f2f5;
}

header {
    background-color: #2c3e50;
    color: white;
    padding: 15px 20px;
    text-align: center;
}

header h1 {
    margin: 0;
    font-size: 1.8rem;
}

#toolbar {
    display: flex;
    flex-wrap: wrap;
    background-color: #ecf0f1;
    padding: 10px;
    gap: 8px;
    border-bottom: 1px solid #ccc;
    align-items: center;
}

#toolbar button, #toolbar select, #toolbar input {
    border: none;
    background-color: #2980b9;
    color: white;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: 0.2s;
}

#toolbar button:hover, #toolbar select:hover, #toolbar input:hover {
    background-color: #1c5980;
}

#editor {
    flex: 1;
    margin: 20px auto;
    padding: 20px;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    overflow-y: auto;
    width: 21cm; 
    min-height: 29.7cm; 
    box-sizing: border-box;
    color: black;
}

#editor[contenteditable="true"] {
    outline: none;
}

#settings {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-left: 10px;
}

#settings label {
    font-size: 0.9rem;
    color: #333;
}

@media print {
    body { background-color: white; }
    #editor { box-shadow: none; width: 100%; min-height: auto; }
}
</style>
</head>
<body>

<header>
    <h1>Nexa Writer</h1>
</header>

<div id="toolbar">
    <button onclick="formatText('bold')"><b>Gras</b></button>
    <button onclick="formatText('italic')"><i>Italique</i></button>
    <button onclick="formatText('underline')"><u>SoulignÃ©</u></button>
    <button onclick="formatText('justifyLeft')">Gauche</button>
    <button onclick="formatText('justifyCenter')">Centre</button>
    <button onclick="formatText('justifyRight')">Droite</button>

    <label>Police:
        <select id="fontFamily" onchange="changeFont()">
            <option value="Segoe UI">Segoe UI</option>
            <option value="Arial">Arial</option>
            <option value="Times New Roman">Times New Roman</option>
            <option value="Courier New">Courier New</option>
        </select>
    </label>

    <label>Taille:
        <input type="number" id="fontSize" value="14" min="8" max="72" onchange="changeFontSize()"> px
    </label>

    <div id="settings">
        <label>Marge (cm):
            <input type="number" id="margin" value="2" min="0" max="5" step="0.1" onchange="updateMargins()"> 
        </label>
        <label>Orientation:
            <select id="orientation" onchange="updateOrientation()">
                <option value="portrait">Portrait</option>
                <option value="landscape">Paysage</option>
            </select>
        </label>
        <label>Couleur de fond:
            <input type="color" id="bgColor" value="#ffffff" onchange="updateBGColor()">
        </label>
        <label>Couleur du texte:
            <input type="color" id="textColor" value="#000000" onchange="updateTextColor()">
        </label>
    </div>

    <select id="saveFormat">
        <option value="html">HTML</option>
        <option value="txt">TXT</option>
        <option value="pdf">PDF</option>
    </select>

    <button onclick="saveFile()">ðŸ’¾ Sauvegarder</button>
    <button onclick="clearText()">ðŸ—‘ Effacer</button>
</div>

<div id="editor" contenteditable="true">
    Commencez Ã  Ã©crire votre texte ici...
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const editor = document.getElementById('editor');

function formatText(command) {
    document.execCommand(command, false, null);
}

function changeFont() {
    const font = document.getElementById('fontFamily').value;
    document.execCommand('fontName', false, font);
}

function changeFontSize() {
    const size = document.getElementById('fontSize').value;
    document.execCommand('fontSize', false, 7);
    const spans = document.querySelectorAll('span[style*="font-size"]');
    spans.forEach(span => span.style.fontSize = size + 'px');
}

function clearText() {
    if(confirm('Voulez-vous vraiment effacer tout le texte ?')) editor.innerHTML = '';
}

function updateMargins() {
    const m = document.getElementById('margin').value;
    editor.style.padding = `${m}cm`;
}

function updateOrientation() {
    const o = document.getElementById('orientation').value;
    if(o === 'portrait') {
        editor.style.width = '21cm';
        editor.style.minHeight = '29.7cm';
    } else {
        editor.style.width = '29.7cm';
        editor.style.minHeight = '21cm';
    }
}

function updateBGColor() {
    editor.style.backgroundColor = document.getElementById('bgColor').value;
}

function updateTextColor() {
    editor.style.color = document.getElementById('textColor').value;
}

function saveFile() {
    const format = document.getElementById('saveFormat').value;
    if(format === 'txt') {
        const blob = new Blob([editor.innerText], { type: 'text/plain' });
        downloadBlob(blob, 'Document.txt');
    } else if(format === 'html') {
        const content = `<!DOCTYPE html>
<html lang="fr">
<head><meta charset="UTF-8"><title>Document Nexa Writer</title></head>
<body style="padding:${document.getElementById('margin').value}cm; background-color:${editor.style.backgroundColor}; color:${editor.style.color}; font-family:${document.getElementById('fontFamily').value}; font-size:${document.getElementById('fontSize').value}px;">
${editor.innerHTML}</body></html>`;
        const blob = new Blob([content], { type: 'text/html' });
        downloadBlob(blob, 'Document.html');
    } else if(format === 'pdf') {
        const { jsPDF } = window.jspdf;
        const orientation = document.getElementById('orientation').value;
        const doc = new jsPDF({ unit: 'cm', format: 'a4', orientation });
        doc.setTextColor(editor.style.color);
        doc.html(editor, {
            callback: function(pdf) { pdf.save('Document.pdf'); },
            x: parseFloat(document.getElementById('margin').value),
            y: parseFloat(document.getElementById('margin').value)
        });
    }
}

function downloadBlob(blob, filename) {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    a.click();
    URL.revokeObjectURL(a.href);
}
</script>

</body>
</html>
